<div class="container">
  <div class="max_calculation_page">
    <div class="form-container green-theme">
      <form
        class="max_form"
        [formGroup]="maxForm"
        (ngSubmit)="onMaxFormSubmit()"
        (reset)="onMaxFormReset()"
      >
        <h1>Provide Financial Details</h1>
        <mat-form-field
          appearance="fill"
          [floatLabel]="getMaxFormFloatLabelValue()"
        >
          <mat-label for="monthlyIncomeAfterTaxes"
            >Monthly income after tax</mat-label
          >
          <input
            matInput
            type="number"
            formControlName="monthlyIncomeAfterTaxes"
            id="monthlyIncomeAfterTaxes"
            placeholder="Monthly income after tax"
          />

          <mat-error
            *ngIf="
              monthlyIncomeAfterTaxes.errors && monthlyIncomeAfterTaxes.touched
            "
          >
            <div *ngIf="monthlyIncomeAfterTaxes.errors['required']">
              Monthly income is required
            </div>
            <div *ngIf="monthlyIncomeAfterTaxes.errors['min']">
              Monthly income can't be less than 0
            </div>
          </mat-error>
        </mat-form-field>
        <mat-form-field
          appearance="fill"
          [floatLabel]="getMaxFormFloatLabelValue()"
        >
          <mat-label for="existingLiabilities"
            >Monthly payment for existing liabilities</mat-label
          >
          <input
            matInput
            type="number"
            formControlName="existingLiabilities"
            id="existingLiabilities"
            placeholder="Monthly payment for existing liabilities"
          />

          <mat-error
            *ngIf="existingLiabilities.errors && existingLiabilities.touched"
          >
            <div *ngIf="existingLiabilities.errors['required']">
              Monthly payment for liabilities is required
            </div>
            <div *ngIf="existingLiabilities.errors['min']">
              Monthly payment for liabilities can't be less than 0
            </div>
          </mat-error>
        </mat-form-field>
        <mat-form-field
          appearance="fill"
          [floatLabel]="getMaxFormFloatLabelValue()"
        >
          <mat-label for="noOfDependents"
            >Number of underage dependents</mat-label
          >
          <mat-select
            formControlName="noOfDependents"
            id="noOfDependents"
            placeholder="Monthly income after tax"
          >
            <mat-option value="0">0</mat-option>
            <mat-option value="1">1</mat-option>
            <mat-option value="2">2</mat-option>
            <mat-option value="3">3</mat-option>
            <mat-option value="4">4</mat-option>
            <mat-option value="5">5</mat-option>
            <mat-option value="6">6</mat-option>
            <mat-option value="7">7</mat-option>
          </mat-select>

          <mat-error *ngIf="noOfDependents.errors && noOfDependents.touched">
            <div *ngIf="noOfDependents.errors['required']">
              Number of underage dependents is required
            </div>
          </mat-error>
        </mat-form-field>
        <div class="button-area max_form_btn_box">
          <button
            type="submit"
            mat-raised-button
            color="accent"
            class="btn-calc"
          >
            Calculate
          </button>
          <button
            type="reset"
            mat-raised-button
            color="accent"
            class="btn-reset"
          >
            Reset
          </button>
        </div>
      </form>
    </div>
    <div *ngIf="maxAmounts$">
      <div class="vl"></div>
    </div>
    <div class="calculation-container" *ngIf="isLoading">
      <div class="spinner-7" *ngIf="isLoading"></div>
    </div>
    <div class="calculation-container" *ngIf="savedData && !isLoading">
      <img src="../../assets/img/flat.png" class="max_amount_img" />

      <div class="calc-text" *ngIf="maxAmounts$ | async as results">
        <div class="text-group">
          <span class="imp-text">Maximum Loan Amount: </span>
          <span class="amount">{{ results.maxLoanAmount }} EUR</span>
        </div>
        <div class="text-group">
          <span class="imp-text">Maximum Monthly Payment: </span>
          <span class="amount">{{ results.maxMonthlyPayment }} EUR</span>
        </div>
      </div>
    </div>
  </div>
</div>
